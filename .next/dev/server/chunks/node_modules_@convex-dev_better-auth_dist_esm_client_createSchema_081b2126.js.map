{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@convex-dev/better-auth/dist/esm/client/createSchema.js","sources":["file:///home/abhi/Coding/Project_0/project0/node_modules/%40convex-dev/better-auth/src/client/createSchema.ts"],"sourcesContent":["import type { BetterAuthDBSchema, DBFieldAttribute } from \"better-auth/db\";\n\n// Manually add fields to index on for schema generation,\n// all fields in the schema specialFields are automatically indexed\nexport const indexFields = {\n  account: [\"accountId\", [\"accountId\", \"providerId\"], [\"providerId\", \"userId\"]],\n  rateLimit: [\"key\"],\n  session: [\"expiresAt\", [\"expiresAt\", \"userId\"]],\n  verification: [\"expiresAt\", \"identifier\"],\n  user: [[\"email\", \"name\"], \"name\", \"userId\"],\n  passkey: [\"credentialID\"],\n  oauthConsent: [[\"clientId\", \"userId\"]],\n};\n\n// Return map of unique, sortable, and reference fields\nconst specialFields = (tables: BetterAuthDBSchema) =>\n  Object.fromEntries(\n    Object.entries(tables)\n      .map(([key, table]) => {\n        const fields = Object.fromEntries(\n          Object.entries(table.fields)\n            .map(([fieldKey, field]) => [\n              field.fieldName ?? fieldKey,\n              {\n                ...(field.sortable ? { sortable: true } : {}),\n                ...(field.unique ? { unique: true } : {}),\n                ...(field.references ? { references: field.references } : {}),\n              },\n            ])\n            .filter(([_key, value]) =>\n              typeof value === \"object\" ? Object.keys(value).length > 0 : true\n            )\n        );\n        return [key, fields];\n      })\n      .filter(([_key, value]) =>\n        typeof value === \"object\" ? Object.keys(value).length > 0 : true\n      )\n  );\n\nconst mergedIndexFields = (tables: BetterAuthDBSchema) =>\n  Object.fromEntries(\n    Object.entries(tables).map(([key, table]) => {\n      const manualIndexes =\n        indexFields[key as keyof typeof indexFields]?.map((index) => {\n          return typeof index === \"string\"\n            ? table.fields[index]?.fieldName ?? index\n            : index.map((i) => table.fields[i]?.fieldName ?? i);\n        }) || [];\n      const specialFieldIndexes = Object.keys(\n        specialFields(tables)[key as keyof ReturnType<typeof specialFields>] ||\n          {}\n      ).filter(\n        (index) =>\n          !manualIndexes.some((m) =>\n            Array.isArray(m) ? m[0] === index : m === index\n          )\n      );\n      return [key, manualIndexes.concat(specialFieldIndexes)];\n    })\n  );\n\nexport const createSchema = async ({\n  file,\n  tables,\n}: {\n  tables: BetterAuthDBSchema;\n  file?: string;\n}) => {\n  // stop convex esbuild from throwing over this import, only runs\n  // in the better auth cli\n  const pathImport = \"path\";\n  const path = await import(pathImport);\n  const baseName = path.basename(path.resolve(process.cwd(), file ?? \"\"));\n  // if the target directory is named \"convex\", they're almost definitely\n  // generating the schema in the wrong directory, likely would replace the\n  // app schema\n  if (baseName === \"convex\") {\n    throw new Error(\n      \"Better Auth schema must be generated in the Better Auth component directory.\"\n    );\n  }\n  let code: string = `// This file is auto-generated. Do not edit this file manually.\n// To regenerate the schema, run:\n// \\`npx @better-auth/cli generate --output ${file} -y\\`\n\nimport { defineSchema, defineTable } from \"convex/server\";\nimport { v } from \"convex/values\";\n\nexport const tables = {\n`;\n\n  for (const tableKey in tables) {\n    const table = tables[tableKey]!;\n    const modelName = table.modelName;\n\n    // No id fields in Convex schema\n    const fields = Object.fromEntries(\n      Object.entries(table.fields).filter(([key]) => key !== \"id\")\n    );\n\n    function getType(name: string, field: DBFieldAttribute) {\n      const type = field.type as\n        | \"string\"\n        | \"number\"\n        | \"boolean\"\n        | \"date\"\n        | \"json\"\n        | `${\"string\" | \"number\"}[]`;\n\n      const typeMap: Record<typeof type, string> = {\n        string: `v.string()`,\n        boolean: `v.boolean()`,\n        number: `v.number()`,\n        date: `v.number()`,\n        json: `v.string()`,\n        \"number[]\": `v.array(v.number())`,\n        \"string[]\": `v.array(v.string())`,\n      } as const;\n      return typeMap[type];\n    }\n\n    const indexes =\n      mergedIndexFields(tables)[\n        tableKey as keyof typeof mergedIndexFields\n      ]?.map((index) => {\n        const indexArray = Array.isArray(index) ? index.sort() : [index];\n        const indexName = indexArray.join(\"_\");\n        return `.index(\"${indexName}\", ${JSON.stringify(indexArray)})`;\n      }) || [];\n\n    const schema = `${modelName}: defineTable({\n${Object.keys(fields)\n  .map((field) => {\n    const attr = fields[field]!;\n    const type = getType(field, attr as DBFieldAttribute);\n    const optional = (fieldSchema: string) =>\n      attr.required\n        ? fieldSchema\n        : `v.optional(v.union(v.null(), ${fieldSchema}))`;\n    return `    ${attr.fieldName ?? field}: ${optional(type)},`;\n  })\n  .join(\"\\n\")}\n  })${indexes.length > 0 ? `\\n    ${indexes.join(\"\\n    \")}` : \"\"},\\n`;\n    code += `  ${schema}`;\n  }\n\n  code += `};\n\nconst schema = defineSchema(tables);\n\nexport default schema;\n`;\n\n  return {\n    code,\n    path: file ?? \"./schema.ts\",\n    overwrite: true,\n  };\n};\n"],"names":[],"mappings":"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","debugId":null}}]
}